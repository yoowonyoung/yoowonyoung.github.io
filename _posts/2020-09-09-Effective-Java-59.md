---
layout: post
title: "Effective Java - 아이템59: 라이브러리를 익히고 사용하라"
description: 라이브러리를 익히고 사용하라
date: 2020-09-09 19:55:00 +09:00
categories: EffectiveJava Study
---


# 일반적인 프로그래밍 원칙

## 아이템 59 : 라이브러리를 익히고 사용하라

- 무작위 정수를 하나 만드는 메서드를 만들때, 대부분의 프로그래머가 다음과 같은 메서드를 만들것이다

```java
static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) %n;
}
```

- 위 코드는 괞찮은듯 보여도 문제를 3가지나 가지고있다
    * n이 크지 않은 2의 제곱수라면 얼마 지나지 않아 같은 수열이 반복될것이다
    * n이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 더 자주 반환된다, n의 값이 크면 이러한 현상은 더 두드러진다
    * 지정한 범위 바깥의수가 종종 튀어나올 수 있다
        + rnd.nextInt()가 반환한 값을 음수가 아닌 정수로 매칭하는데, rnd.nextInt()가 Integer.MIN_VALUE를 반환하면 Math.abs도 역시 Integer.MIN_VALUE를 반환 해버린다!

- 이 결함을 해결하려면 의사난수 생성기, 정수론, 2의보수 계산등에 조예가 깊어야 한다. 다행이 이는 우리가 해결할 필요는 없는데, Random.nextInt(int)가 이 문제를 해결해두었기 때문이다
- 이 메서드의 자세한 동작방식은 몰라도 된다. 알고리즘에 능통한 개발자가 설계와 구현과 검증에 시간을 들여 개발했고, 이 분야의 여러 전문가가 잘 동작함을 검증 해줫기 때문이다
    * 또한 이 라이브러리가 릴리즈된후 20여년 가까이 수백만의 개발자가 사용했지만, 버그가 보고된적이 없다! 버그가 보고되더라도 다음 릴리즈에 수정될것이다

- 이처럼 표준 라이브러리를 사용하면 그 코드를 작성한 전문가의 지식과 여러분보다 앞서 사용한 다른 프로그래머들의 경험을 활용할 수 있다
- 자바7 이후부터는 Random을 더이상 사용하지 않는게 좋은데, ThreadLocalRandom이 대체 해줄것이다. Random보다 더 고품질의 무작위수를 생성할뿐만 아니라 속도도 더 빠르다
    * 포크-조인 풀이나 병렬 스트림에서는 SplittableRandom을 사용해야한다

- 표준 라이브러리를 쓰는 두번재 이점은 핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 된다는 것이다
- 세번째 이점은 따로 노력하지 않아도 성능이 지속해서 개선된다는것인데, 사용자가 많고, 업계 표준 벤치마크를 사용해 성능을 확인하기 때문에, 표준 라이브러리 제작자들은 더 나은 방법을 꾸준히 모색 할 수 밖에 없다
- 네번째 이점은 기능이 점점 많아진다는 것이다. 라이브러리에 부족한 부분이 있다면 개발자 커뮤니티에 이야기가 나오고 논의된 후 해당 기능이 다음 릴리즈에 추가될것이다
- 마지막 이점은 우리가 작성한 코드가 많은 사람들에게 낯익은 코드가 될거라는것이다. 자연스럽게 다른 개발자들이 더 읽기 좋고, 유지보수하기 좋고, 재활용 하기 쉬운 코드가 될것이다
- 이러한 이점들이 있지만, 많은 프로그래머들이 표준라이브러리가 아닌 직접 구현을 해서 사용하고 있다. 라이브러리에 그런 기능이 있는지 모르기 때문이다!
- 메이저 릴리즈마다 주목할만한 수많은 기능이 라이브러리에 추가 된다. 이는 한번쯤 읽어볼만 하다
- 한가지 예로 자바9에서 추가된 InputStream의 transferTo 메서드를 이용해서 리눅스의 curl명령과 같은 명령줄 애플리케이션은 다음과 같이 만들 수 있다

```java
public static void main(String[] args) throw IOException {
    try ( InputStream in = new URL(args[0]).openStream()) {
        in.transferTo(Syste.out);
    }
}
```

- 라이브러리가 너무 방대하여 모든 API문서를 공부하기는 벅차겟지만 자바 프로그래머라면 적어도 java.lang, java.util, java.io와 그 하위 패키지에는 익숙해져야 한다
- 또 언급해둘만한 라이브러리로는 컬렉션 프레임워크와 스트림 라이브러리가 있을것이다
- java.util.concurrent의 동시성 기능도 마찬가지인데, 이 패키지는 멀티스레드 프로그래밍 작업을 단순화 해주는 고수준의 편의기능은 물론, 능숙한 개발자가 자신만의 고수준 개념을 직접 구현할 수 있는 저수준 요소들도 제공한다
- 때때로 라이브러리가 우리에게 필요한 기능을 충분히 제공해주지 못할수도 있다. 더 전문적인 기능을 요구할수록 이런일은 더 자주 생길것이지만, 우선은 라이브러리를 사용하려 시도해보자
- 자바의 표준 라이브러리에서 원하는 기능을 찾지 못한다면 그 다음은 고품질의 서드파티 라이브러리이다. 구글의 구아바 라이브러리가 대표적인데, 여기까지 왓는데도 찾지 못했다면, 그때 구현을 시도하라