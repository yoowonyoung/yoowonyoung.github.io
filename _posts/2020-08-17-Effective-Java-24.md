---
layout: post
title: "Effective Java - 아이템24: 멤버클래스는 되도록 static으로 만들어라"
description: 멤버클래스는 되도록 static으로 만들어라
date: 2020-08-17 16:39:00 +09:00
categories: EffectiveJava Study
---


# 클래스와 인터페이스

## 아이템 24 : 멤버클래스는 되도록 static으로 만들어라

- 중첩 클래스란 다른 클래스안에 정의된 클래스를 말하는데, 중첩 클래스는 자기 자신을 감싼 바깥 클래스에서만 쓰여야 하며, 그 이외의 쓰임새가 있다면 톱레벨 클래스로 만들어야 한다
- 중첩 클래스의 종류로는 정적 멤버 클래스, 멤버 클래스, 익명 클래스, 지역 클래스 이렇게 4가지 이다
- 이중 첫번쨰를 제외한 나머지는 내부 클래스에 해당하는데, 이러한 중첩 클래스들은 각각의 사용처가 따로 있다
- 먼저 정적 멤버 클래스는 다른 클래스 안에 선언되고, 바깥 클래스의 private 멤버에도 접근 할 수 있다는 점을 제외하면 일반 클래스와 똑같다
- 정적 멤버 클래스는 다른 정적 멤버와 똑같은 접근규칙을 적용받는다
- 정적 멤버 클래스는 바깥 클래스와 함께 쓰일떄만 유용한 public 도우미 클래스로 쓰여야 한다(ex> 계산기의 연산 종류를 나타내는 Calculator.Operation.MINUS )
- 정적 멤버 클래스와 비정적 멤버 클래스의 구문상 차이는 단지 static이 붙고 안붙고 차이지만, 의미상의 차이는 크다
- 비정적 멤버 클래스의 인스턴스는 바깥 클래스의 인스턴스와 암묵적으로 연결되는데, 이로인해 비정적 멤버 클래스의 인스턴스 메서드에서 정규화된 this(클래스명.this)를 통해 바깥 인스턴스를 참조할 수 있다
- 따라서 개념상 중첩클래스의 인스턴스가 바깥 인스턴스와 독립적으로 존재할 수있다면 정적 멤버 클래스로 만들어야 한다. 비정적 멤버 클래스는 바깥클래스의 인스턴스 생성 없이는 생성할 수 없기 때문이다
- 비정적 멤버 클래스의 인스턴스와 바깥 인스턴스 사이의 관계는 멤버 클래스각 인스턴스화될 떄 확립되며, 더이상 변경 할 수 없다
- 비정적 멤버 클래스는 어댑터를 정의할때 자주 쓰이는데, Map인터페이스의 구현체들이 보통 이렇게 구현되어있다

```java
public class MySet<E> extneds AbstractSet<E> {
    @Override
    public Iterator<E> iterator() {
        return new MyIterator();
    }

    private class MyIterator implements Iterator<E> {
        ...
    }
}
```

- 멤버 클래스에서 바깥 인스턴스에 접근할 일이 없다면 무조건 static을 붙여서 정적 멤버 클래스로 만들자
- static을 생략하면 바깥 인스턴스로의 숨은 외부 참조를 갖게되며, 이는 시간과 공간이 낭비될뿐만 아니라 가비지컬렉션이 바깥 클래스의 인스턴스를 수거하지 못하게 한다
- private 정적 멤버 클래스는 흔히 바깥 클래스가 표현하는 객체의 한 부분을 나타낼떄 쓰는데, Map의 Key와 Value를 나타내는 Entry들이 대표적이다
- 멤버 클래스가 공개된 클래스의 public이나 protected멤버라면 정적이냐 아니냐는 두배로 중요해지는데, 멤버 클래스 역시 공개 API가 되기 때문이다
- 익명 클래스는 이름도 없고, 바깥 클래스의 멤버도 아니다. 멤버와 달리 쓰이는 시점에 선언과 동시에 인스턴스가 만들어지며 코드의 어디든 만들수있다. 그리고 오직 비 정적임 문맥에서만 사용될떄 바깥 클래스의 인스턴스를 참조할 수 있다. 정적 문맥에서라도 상수 이외의 정적 멤버는 가질 수 없다
- 익명 클래스는 응용하는데 제약이 많은편인데, 선언한 지점에서만 인스턴스화가 되고 instanceof검사나 클래스의 이름이 필요한 작업은 할 수 없다
- 익명 클래스는 여러 인터페이스를 구현 할 수 없고, 인터페이스를 구현하는 동시에 다른 클래스를 상속 할수도 없다
- 익명 클래스를 사용하는 클라이언트는 그 익명클래스가 상위 타입에서 상속한 멤버 외에는 호출할 수 없고, 코드 중간에 익명클래스가 등장 하므로 짧지 않으면 가독성이 떨어진다
- 람다를 지원하기 이전에는 즉석에서 작은 함수 객체나 처리 객체를 만드는데 주로 익명 클래스를 사용했지만, 이제는 람다가 그 위치를 대신한다
- 익명 클래스의 또다른 쓰임은 정적 팩터리 메서드를 구현할떄이다
- 지역 클래스는 가장 드ㄹ물게 사용되는데, 지역 클래스는 지역 변수를 선언할 수 있는곳이면 어디든지 선언 가능하고, 유효범위도 지역변수와 같다
- 지역 클래스는 멤버 클래스처럼 이름이 있고 반복되어 쓰일수있고, 익명 클래스처럼 비정적 문맥에서 사용될깨만 바깥 인스턴스를 참조할수 있으며, 정적 멤버는 가질수 없고 가독성을 위해 짧게 작성해야 한다