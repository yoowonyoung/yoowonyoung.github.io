---
layout: post
title: "Effective Java - 아이템21: 인터페이스는 구현하는쪽을 생각해 설계하라"
description: 인터페이스는 구현하는쪽을 생각해 설계하라
date: 2020-08-17 12:13:00 +09:00
categories: EffectiveJava Study
---


# 클래스와 인터페이스

## 아이템 21 : 인터페이스는 구현하는쪽을 생각해 설계하라

- 자바8 이전까지는 기존 구현체를 깨트리지 않으며 인터페이스에 메서드를 추가할 방법은 없었으며, 디폴트 구현이 생긴 이후에도 이것이 기존 구현체들과 매끄럽게 동작하리란 보장이 없다
- 자바8 에서 컬렉션 인터페이스들에 람다활용을 위한 디폴트 메서드들이 다수 추가 되었는데, 이는 대부분의 상황에서 잘 동작하지만 생각할수 있는 모든 상황에서 불변식을 해치지 않는 디폴트 메서드를 작성하기란 어렵다
- 한가지 예로, 컬렉션 인터페이스에 추가된 removeIf는, 아파치 커먼즈의 SynchronizedCollections 에서는 재정의하고 있지 않으므로 디폴트 구현이 쓰이게 되는데,
SynchronizedCollection의 다른 모든 메서드는 동기화가 되지만 removeIf는 동기화가 되지 않게 되어버린다
- 자바 플랫폼에서도 이런 문제를 예방하기 위해 일련의 조치를 취했는데, 구현한 인터페이스의 디폴트메서드를 재정의 하고, 다른 메서드에서는 디폴트 메서드를 호출하기 전에 필요한 작업을 수행하도록 한것이다
- 예를들어 SynchronizedCollection이 반환하는 package-private 클래스들은 removeIf를 재정의 하고, 이를 호출하는 다른 메서드들으 디폴트 구현을 호출하기전에 동기화를 하도록 했다
- 또한 디폴트메서드는 컴파일에 성공하더라도 기존 구현체에 런타임오류를 일으킬수 있다
- 이처럼 기존 인터페이스에 디폴트메서드로 새 메서드를 추가하는일은 꼭 필요한 경우가 아닌경우 피해야 하며, 추가하려는 디폴트메서드가 기존 구현체들과 충돌을 일으키지는 않는지 심사숙고 해야한다
- 또한 디폴트 메서드는 인터페이스로부터 메서드를 제거하거나 메서드의 시그니처 변경용도가 아님을 명심해야 한다. 이렇게 할 경우 반드시 클라이언트는 무너지게 되어있다
- 핵심은 명백한데, 디폴트메서드라는 새로운 도구가 생겼어도 인터페이스를 설계할땐 항상 세심한 주의를 기울여야 한다는것이다
