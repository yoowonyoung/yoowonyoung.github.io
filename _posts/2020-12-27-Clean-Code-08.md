---
layout: post
title: "Clean Code 09 : 단위 테스트"
description: Clena Code 9장 - 단위 테스트
date: 2020-12-27 18:19:00 +09:00
categories: CleanCode Study
---

# TDD의 법칙 세가지
- 첫째 법칙: 실패하는 단위 테스트를 작성 할 때까지 코드를 작성 하지 않는다
- 둘째 법칙: 컴파일은 실패하지 않으면서 실행이 실패 하는 정도로만 단위 테스트를 작성 한다
- 셋째 법칙: 현재 실패하는 테스트를 통과 할 정도로만 실제 코드를 작성 한다

# 깨끗한 테스트 코드 유지하기
- 테스트는 유연성, 유지보수성, 재사용성을 제공 하므로, 테스트 코드는 실제 코드 못지 않게 중요하다

# 깨끗한 테스트 코드
- 깨끗한 테스트 코드를 만들려면 3가지가 필요한데, 각각 가독성, 가독성, 가독성이다
- 테스트 코드에서의 가독성은 실제 코드에서보다 더더욱 중요하다. 가독성을 높히기위해서 여타 코드처럼 명료성, 단순성, 풍부한 표현력이 필요하다. 테스트 코드는 최소의 표현으로 많은것을 나타내야 한다
- 도메인에 특화된 테스트 언어
    * 도메인에 특화된 언어(DSL)로 테스트를 구현하는 기법은, 흔히 쓰는 시스템 조작API를 사용 하는 대신 API위에 함수와 유틸리티를 구현하여 그 함수와 유틸리티를 사용 하므로 테스트 코드를 짜기도 읽기도 쉬워진다

- 이중 표준
    * 테스트 API코드에 적용하는 표준은 실제 코드에 적용하는 표준과 확실히 다르다
    * 단순하고, 간결하고, 표현력이 풍부해야 하지만 실제 코드만큼 효율적일 필요는 없다. 실제 환경이 아니라 테스트 환경에서 돌아가는 코드이기 때문이다

# 테스트당 assert 하나
- JUnit으로 테스트 코드를 짤때는 함수마다 assert문을 단 하나만 사용해야 한다고 주장하는 학파가 있다
- 가혹한 규칙이라 여겨질지도 모르지만, 확실히 장점이 있다. assert문이 단 하나인 함수는 결론이 하나라서 코드를 이해하기 쉽고 빠르다
- 하지만 때로는 주저없이 함수 하나에 여러 assert문을 넣기도 하는데, 단지 assert문 개수는 최대한 줄여야 좋다
- 테스트당 개념 하나
    * 어쩌면 테스트 함수 하나마다 한 개념만 테스트 하라는 규칙이 더 나을 수 있다
    * 이것 저것 잡다한 개념을 연속으로 테스트 하는 긴 함수는 피한다
    * 따라서 가장 좋은 규칙은 "개념당 assert문 수를 최소로 줄여라" 와 "테스트 함수 하나는 개념 하나만 테스트하라" 이다

# F.I.R.S.T
- 깨끗한 테스트는 다음 다섯가지 규칙을 따른다
- 빠르게(Fast): 테스트는 빨리 돌아야 한다. 테스트가 느리면 자주 돌릴 엄두를 못 낸다
- 독립적으로(Independent): 각 테스트는 서로 의존하면 안된다. 한 테스트가 다음 테스트가 실행될 환경을 준비 해서는 안된다. 각 테스트는 독립적으로 그리고 어떤 순서로 실행 해도 괜찮아야 한다
- 반복 가능하게(Repeatable): 테스트는 어떤 환경에서도 반복 가능해야 한다. 실제 환경, QA환경, 버스를 타고 집으로 가는길에 사용하는 노트북 환경 에서도 실행 할 수 있어야 한다
- 자가 검증하는(Self-Validating): 테스트는 부울 값으로 결과를 내야 한다. 성공 아니면 실패다. 통과 여부를 알기 위해 로그 파일을 읽게 해서는 안되며, 통과 여부를 보기 위해 텍스트파일 두개를 수작업으로 비교 해서도 안된다
- 적시에(Timely): 테스트는 적시에 작성 해야 한다. 단위 테스트는 테스트 하려는 실제 코드를 구현하기 직전에 구현 한다. 실제 코드를 구현한 다음에 테스트 코드를 만들면 실제 코드가 테스트하기 어렵다는 사실을 발견할지도 모른다
